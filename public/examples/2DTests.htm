<!DOCTYPE html>
<html lang="en">
<head>
    <title></title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js"></script>
    <script type="text/javascript" src="..\tccore\browserdetect.js"></script>
    <script type="text/javascript" src="..\tccore\GameEvent.js"></script>
    <script type="text/javascript" src="..\tccore\Frame.js"></script>
    <script type="text/javascript" src="..\tccore\Sprite.js"></script>
    <script type="text/javascript" src="..\tccore\GameWorld.js"></script>
    <script type="text/javascript" src="..\tccore\GameWorldModel2D.js"></script>
    <script type="text/javascript" src="..\tccore\GameWorldModelIso.js"></script>
    <script type="text/javascript" src="..\tccore\Engine.js"></script>
    <script type="text/javascript" src="..\assets\werewolf\werewolf.js"></script>
    <script type="text/javascript" src="..\assets\ninjaGirl\ninjaGirl.js"></script>
    <script type="text/javascript" src="..\assets\Cells\Cells.js"></script>
    <meta content="width=320, user-scalable=0" />
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <script type="text/javascript">
        var ga;
        var worldCells;
        var column;
        $(document).ready(function () {
            ga = new Engine(document.getElementById("gamescreen"), document.getElementById("backbuffer2"));

            //tell the engine our gameworld will consist of a 250x250 grid of 160,79 cells
            var gameWorld = new GameWorld(250, 250, 73, 73, GAME_WORLD_STYLE_2D);
            worldCells = altarCells_Sprite(ga);
            worldCells.setup(ga);

            column = columnCell_Sprite(ga);
            column.setup(ga);

            //loop through the matrix and populate it with cells
            for (var i = 100; i < 400; i++) {
                for (var ii = 100; ii < 400; ii++) {
                    //set a cell using the worldCells sprite, randomly select one of the 25 frames in this sprite.
                    gameWorld.Cells[i][ii].Sprite = worldCells;
                    gameWorld.Cells[i][ii].Frame = getRand(25);
                    gameWorld.Cells[i][ii].Type = GAME_WORLD_CELL_UNDERLAY;
                    gameWorld.Cells[i][ii].BlockType = GAME_WORLD_CELL_OPEN;
                }
            }

            ga.setWorld(gameWorld);
            ga.setCamera(125,125);

            var gameWorldModel = ga.getWorldModel();


            //define a bunch of ninja girl sprites
            for (var i = 0; i < 20; i++) {
                var ng = ninjaGirl_Sprite(ga, "ninjaGirl" + i);
                ng.setup(ga);
                ng.setSpeed(5);
                ng.setLeft(10*i);
                ng.setTop(i*10)
                ga.defineSprite(ng);

            }


            for (var i = 0; i < 5; i++) {
                var col = columnCell_Sprite(ga, "columnCell" + i);
                col.setup(ga);
                col.setSpeed(5);
                col.setLeft(20*i);
                col.setTop(20*i)                                
                ga.defineSprite(col);

            }



            //make a column blocker
            //            for (var i = 0; i < 5; i++) {
            //                gameWorld.setCellBlockType(249-i, 249, GAME_WORLD_CELL_BLOCK);
            //                gameWorld.setCellDrawType(249 - i, 249, GAME_WORLD_CELL_OVERLAY);
            //                gameWorld.setCellSprite(249 - i, 249, column); //clear the cell
            //                gameWorld.setCellFrame(249 - i, 249, 0); //clear the cell
            //            }


            ng.wireArrowKeys("ninjaGirlNeutral", "ninjaGirlAttack", "ninjaGirlAttack", "ninjaGirlAttack", "ninjaGirlAttack");

            var intervalid = setInterval(function () {
                if (column.isLoadComplete() && ng.isLoadComplete() && worldCells.isLoadComplete()) {
                    ga.play();
                    clearInterval(intervalid);
                }
            });
        });

        function getRand(max) {
            return Math.floor(Math.random() * max);
        }
    </script>
</head>
<body>

//todo: fix allow move
    
    <canvas id="gamescreen" width="800" height="600" style="border-style: dotted; float: left;">
        No supporty canvisimo!
    </canvas>    
    <canvas id="backbuffer2" width="800" height="600" style="visibility:hidden; display:none;"></canvas>    
    <div>        
    </div>
    <div id="frameDebug"></div>
</body>
</html>
